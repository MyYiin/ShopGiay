@model IEnumerable<ShopGiay.Models.Mathang>

@{
    ViewData["Title"] = "Sản phẩm theo loại";
    // Lấy tên loại giày từ ViewBag nếu có
    var loaiGiayTen = ViewBag.LoaiGiay as string ?? "Không xác định";
}

<style>
    /* BẢN SAO CSS TỪ TRANG CHỦ ĐỂ ĐỒNG BỘ GIAO DIỆN */
    .product-card {
        border: none;
        border-radius: 12px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        overflow: hidden;
    }

        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }

    .card-img-top {
        border-bottom: 1px solid #eee;
        transition: transform 0.5s ease;
        object-fit: cover;
        height: 200px;
    }

    .product-card a:hover .card-img-top {
        transform: scale(1.05);
    }

    .sale-badge {
        z-index: 10;
        letter-spacing: 0.05em;
        padding: 0.35rem 0.75rem;
        font-weight: 700;
        border-radius: 0 0 0 10px;
    }

    .product-name {
        color: #1e81b0;
        font-size: 1.15rem;
        font-weight: 700;
        margin-bottom: 0.25rem;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .price-original {
        font-size: 0.9rem;
        color: #999;
        text-decoration: line-through;
    }

    .price-sale {
        font-size: 1.25rem;
        color: #e74c3c;
        font-weight: 900;
        margin-left: 5px;
    }
</style>

<div class="container mt-4">
    <!-- Tiêu đề động theo loại giày --><h3 class="mb-4 text-center fw-bold">
        <i class="bi bi-tag-fill me-2 text-primary"></i>Sản phẩm thuộc loại: @loaiGiayTen
    </h3>

    <div class="row">
        @if (Model != null && Model.Any())
        {
            @foreach (var item in Model)
            {
                <div class="col-6 col-md-3 mb-4">
                    <div class="card h-100 product-card">

                        @if (item.GiaGoc.HasValue && item.GiaGoc > item.GiaBan)
                        {
                            <div class="badge bg-danger text-white position-absolute sale-badge" style="top: 0; right: 0;">
                                SALE
                            </div>
                        }

                        <a asp-action="Details" asp-controller="Mathangs" asp-route-id="@item.MaMh" style="display: block; overflow: hidden;">
                            <img class="card-img-top" src="~/images/products/@Html.DisplayFor(modelItem => item.HinhAnh)" alt="@Html.DisplayFor(modelItem => item.Ten)" />
                        </a>

                        <div class="card-body p-4">
                            <div class="text-center">
                                <a asp-action="Details" asp-controller="Mathangs" asp-route-id="@item.MaMh" class="text-decoration-none">
                                    <h5 class="product-name" title="@Html.DisplayFor(modelItem => item.Ten)">@Html.DisplayFor(modelItem => item.Ten)</h5>
                                </a>

                                <div class="d-flex justify-content-center small text-warning mb-2">
                                    <div class="bi-star-fill"></div>
                                    <div class="bi-star-fill"></div>
                                    <div class="bi-star-fill"></div>
                                    <div class="bi-star-fill"></div>
                                    <div class="bi-star"></div>
                                </div>

                                <div>
                                    @if (item.GiaGoc.HasValue && item.GiaGoc > item.GiaBan)
                                    {
                                        <span class="price-original">@string.Format("{0:N0}₫", item.GiaGoc)</span>
                                    }
                                    <span class="price-sale">@string.Format("{0:N0}₫", item.GiaBan)</span>
                                </div>
                            </div>
                        </div>

                        <div class="card-footer p-4 pt-0 border-top-0 bg-transparent">
                            <div class="d-flex justify-content-between align-items-center">
                                <a asp-controller="Customers"
                                   asp-action="Details"
                                   asp-route-id="@item.MaMh"
                                   class="btn btn-outline-secondary btn-sm flex-grow-1 me-2">
                                    <i class="bi bi-eye"></i> Chi tiết
                                </a>

                                <a asp-controller="Customers"
                                   asp-action="AddToCart"
                                   asp-route-id="@item.MaMh"
                                   class="btn btn-success btn-sm flex-grow-1 text-white fw-bold">
                                    <i class="bi bi-bag-plus-fill"></i> Mua hàng
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            }
        }
        else
        {
            <div class="col-12 text-center py-5">
                <p class="lead text-muted">Không tìm thấy sản phẩm nào thuộc loại này.</p>
                <a asp-controller="Customers" asp-action="Index" class="btn btn-primary">Quay lại Trang chủ</a>
            </div>
        }
    </div>
</div>