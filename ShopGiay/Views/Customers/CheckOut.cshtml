@model List<ShopGiay.Models.CartItem>
@{
    ViewData["Title"] = "Thanh toán";
}
<p>Vui lòng kiểm tra đầy đủ thông tin trước khi hoàn tất đơn hàng</p>

@if (TempData["ErrorMessage"] != null)
{
    <div class="alert alert-danger" role="alert">
        @TempData["ErrorMessage"]
    </div>
}

<div class="row">
    <div class="col">
        <h4 class="text-info">Thông tin khách hàng</h4>
        <form asp-action="CreateBill" method="post">
            @Html.AntiForgeryToken()
            <div class="mb-3">
                <label>Email <span class="text-danger">*</span></label>
                <input name="email" class="form-control" type="email" value="@ViewBag.CustomerEmail" required />
            </div>
            <div class="mb-3">
                <label>Họ tên <span class="text-danger">*</span></label>
                <input name="hoten" class="form-control" type="text" value="@ViewBag.CustomerName" required />
            </div>
            <div class="mb-3">
                <label>Điện thoại <span class="text-danger">*</span></label>
                <input name="dienthoai" class="form-control" type="text" value="@ViewBag.CustomerPhone" required />
            </div>
            <div class="mb-3">
                <label>Địa chỉ <span class="text-danger">*</span></label>
                <textarea name="diachi" class="form-control" required>@ViewBag.CustomerAddress</textarea>
            </div>
            <div class="mb-3">
                <input type="submit" class="btn btn-primary" value="Xác nhận đơn hàng" />
            </div>
        </form>

    </div>
    <div class="col">
        <h4 class="text-info">Thông tin đơn hàng</h4>
        @if (Model.Count > 0)
        {
            int stt = 1;        // số thứ tự
            int thanhtien = 0;     // thành tiền
            int tongtien = 0;      // tổng tiền

            <table class="table">
                <tr class="table-info">
                    <th>STT</th>
                    <th>Sản phẩm</th>
                    <th>Giá</th>
                    <th>Số lượng</th>
                    <th>Thành tiền</th>

                </tr>
                @foreach (var i in Model)
                {
                    thanhtien = i.MatHang.GiaBan * i.SoLuong ?? 1;
                    tongtien += thanhtien;
                    <tr class="align-middle">
                        <td>@(stt++)</td>
                        <td>
                            <img src="~/images/products/@(i.MatHang.HinhAnh)"
                                 class="img-thumbnail" width="50" />
                            @(i.MatHang.Ten)
                        </td>
                        <td>@(i.MatHang.GiaBan?.ToString("n0")) đ</td>
                        <td>@(i.SoLuong)</td>
                        <td>@(thanhtien.ToString("n0")) đ</td>

                    </tr>
                }
                <tr>
                    <td colspan="4" class="text-end fw-bold">Thành tiền</td>
                    <td>
                        <strong class="text-danger">
                            @(tongtien.ToString("n0"))
                            đ
                        </strong>
                    </td>
                </tr>
            </table>

        }
    </div>
</div> 